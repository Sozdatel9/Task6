@using Task6.Entities;
@using Task6.Logic;
@using Task6.StaticClasses;

@if (!User.Identity.IsAuthenticated)
{
    Response.SetStatus(HttpStatusCode.Unauthorized);
    return;
}
@if (!User.IsInRole("admin"))
{
    Response.SetStatus(HttpStatusCode.Forbidden);
    return;
}

@{
    Page.Title = "Delete users";
    Page.Description = "Delete selected user";

    if (IsPost)
    {
        var userId = Request["id"];
        if (string.IsNullOrWhiteSpace(userId))
        {
            Response.SetStatus(HttpStatusCode.BadRequest);
            return;
        }

        staticClasses.userLogic.Delete(int.Parse(userId));
        Response.Redirect("~/Pages/Users/");
        return;
    }
}